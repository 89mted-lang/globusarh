<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>График занятости сотрудников</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1>График занятости сотрудников</h1>
                <div class="current-date" id="currentDate"></div>
            </div>
            <div class="header-controls">
                <button class="btn btn--primary" id="addTaskBtn">Добавить задачу</button>
                <button class="btn btn--secondary" id="addEmployeeBtn">Добавить сотрудника</button>
                <button class="btn btn--outline" id="exportExcelBtn">Выгрузить в Excel</button>
                <button class="btn btn--outline" id="saveDataBtn">Сохранить данные</button>
                <button class="btn btn--outline" id="loadDataBtn">Загрузить данные</button>
                <input type="file" id="fileInput" accept=".json" class="hidden">
            </div>
        </header>

        <div class="filters">
            <div class="filter-group">
                <label class="form-label">Фильтр по сотруднику:</label>
                <select class="form-control filter-select" id="employeeFilter">
                    <option value="">Все сотрудники</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="form-label">Фильтр по статусу:</label>
                <select class="form-control filter-select" id="statusFilter">
                    <option value="">Все статусы</option>
                    <option value="активная">Активная</option>
                    <option value="завершена">Завершена</option>
                    <option value="отменена">Отменена</option>
                    <option value="не начатая">Не начатая</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="form-label">Поиск задач:</label>
                <input type="text" class="form-control" id="searchInput" placeholder="Введите название задачи...">
            </div>
            <div class="filter-group">
                <label class="form-label">Группировка:</label>
                <select class="form-control filter-select" id="groupFilter">
                    <option value="">Без группировки</option>
                    <option value="employee">По сотруднику</option>
                    <option value="status">По статусу</option>
                </select>
            </div>
        </div>

        <!-- Переключатель видов -->
        <div class="view-switcher">
            <button class="btn btn--outline view-btn active" id="bothViewBtn" data-view="both">Оба вида</button>
            <button class="btn btn--outline view-btn" id="chartViewBtn" data-view="chart">Диаграмма</button>
            <button class="btn btn--outline view-btn" id="tableViewBtn" data-view="table">Таблица</button>
        </div>

        <!-- Навигация по времени -->
        <div class="timeline-navigation" id="timelineNavigation">
            <button class="btn btn--outline btn--sm" id="prevMonth">← Предыдущий месяц</button>
            <div class="current-month" id="currentMonth"></div>
            <button class="btn btn--outline btn--sm" id="nextMonth">Следующий месяц →</button>
        </div>

        <!-- Диаграмма Ганта -->
        <div class="main-content" id="ganttSection">
            <div class="gantt-container">
                <div class="gantt-header">
                    <div class="employee-column-header">
                        <span>Сотрудники</span>
                    </div>
                    <div class="timeline-header" id="timelineHeader">
                        <!-- Временная шкала будет сгенерирована JS -->
                    </div>
                </div>
                <div class="gantt-body" id="ganttBody">
                    <!-- Диаграмма Ганта будет сгенерирована JS -->
                </div>
            </div>
        </div>

        <!-- Таблица задач -->
        <div class="table-section" id="tableSection">
            <div class="table-header">
                <h2>Список задач</h2>
                <div class="table-controls">
                    <button class="btn btn--outline btn--sm" id="selectAllBtn">Выбрать все</button>
                    <button class="btn btn--outline btn--sm" id="deleteSelectedBtn">Удалить выбранные</button>
                    <button class="btn btn--outline btn--sm" id="exportTableBtn">Экспорт таблицы</button>
                </div>
            </div>
            <div class="table-container">
                <table class="tasks-table" id="tasksTable">
                    <thead>
                        <tr>
                            <th class="checkbox-column">
                                <input type="checkbox" id="selectAllCheckbox">
                            </th>
                            <th class="sortable" data-column="employee">
                                Сотрудник
                                <span class="sort-indicator"></span>
                            </th>
                            <th class="sortable" data-column="type">
                                Тип
                                <span class="sort-indicator"></span>
                            </th>
                            <th class="sortable" data-column="title">
                                Описание
                                <span class="sort-indicator"></span>
                            </th>
                            <th class="sortable" data-column="startDate">
                                Дата начала
                                <span class="sort-indicator"></span>
                            </th>
                            <th class="sortable" data-column="endDate">
                                Дата окончания
                                <span class="sort-indicator"></span>
                            </th>
                            <th class="sortable" data-column="status">
                                Статус
                                <span class="sort-indicator"></span>
                            </th>
                            <th class="actions-column">Действия</th>
                        </tr>
                    </thead>
                    <tbody id="tasksTableBody">
                        <!-- Строки таблицы будут сгенерированы JS -->
                    </tbody>
                </table>
            </div>
            <div class="table-pagination" id="tablePagination">
                <div class="pagination-info">
                    Показано <span id="paginationStart">0</span>-<span id="paginationEnd">0</span> из <span id="paginationTotal">0</span> задач
                </div>
                <div class="pagination-controls">
                    <button class="btn btn--outline btn--sm" id="prevPageBtn">← Предыдущая</button>
                    <span class="pagination-pages" id="paginationPages"></span>
                    <button class="btn btn--outline btn--sm" id="nextPageBtn">Следующая →</button>
                </div>
            </div>
        </div>

        <div class="task-legend">
            <div class="legend-title">Легенда:</div>
            <div class="legend-items">
                <div class="legend-item">
                    <div class="legend-color task-type-task status-active"></div>
                    <span>Задача - активная</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color task-type-task status-not-started"></div>
                    <span>Задача - не начатая</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color task-type-vacation status-active"></div>
                    <span>Отпуск - активный</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color task-type-vacation status-not-started"></div>
                    <span>Отпуск - не начатый</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-completed"></div>
                    <span>Завершена</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color status-cancelled"></div>
                    <span>Отменена</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно для добавления/редактирования задачи -->
    <div class="modal hidden" id="taskModal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="taskModalTitle">Добавить задачу</h3>
                <button class="modal-close" id="closeTaskModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <div class="form-group">
                        <label class="form-label">Сотрудник:</label>
                        <select class="form-control" id="taskEmployee" required>
                            <option value="">Выберите сотрудника</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Название задачи:</label>
                        <input type="text" class="form-control" id="taskTitle" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Описание:</label>
                        <textarea class="form-control" id="taskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Дата начала:</label>
                            <input type="date" class="form-control" id="taskStartDate" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Дата окончания:</label>
                            <input type="date" class="form-control" id="taskEndDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Тип задачи:</label>
                            <select class="form-control" id="taskType" required>
                                <option value="">Выберите тип</option>
                                <option value="Задача">Задача</option>
                                <option value="Отпуск">Отпуск</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Статус:</label>
                            <select class="form-control" id="taskStatus" required>
                                <option value="">Выберите статус</option>
                                <option value="активная">Активная</option>
                                <option value="завершена">Завершена</option>
                                <option value="отменена">Отменена</option>
                                <option value="не начатая">Не начатая</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn--secondary" id="cancelTaskBtn">Отмена</button>
                        <button type="submit" class="btn btn--primary">Сохранить</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Модальное окно для добавления сотрудника -->
    <div class="modal hidden" id="employeeModal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Добавить сотрудника</h3>
                <button class="modal-close" id="closeEmployeeModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="employeeForm">
                    <div class="form-group">
                        <label class="form-label">Имя сотрудника:</label>
                        <input type="text" class="form-control" id="employeeName" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn--secondary" id="cancelEmployeeBtn">Отмена</button>
                        <button type="submit" class="btn btn--primary">Добавить</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Контекстное меню -->
    <div class="context-menu hidden" id="contextMenu">
        <div class="context-menu-item" id="editTask">Редактировать</div>
        <div class="context-menu-item" id="deleteTask">Удалить</div>
        <div class="context-menu-item" id="toggleStatus">Изменить статус</div>
    </div>

    <!-- Уведомления -->
    <div class="notification hidden" id="notification">
        <span id="notificationText"></span>
    </div>

    <script src="app.js"></script>
</body>
</html>
